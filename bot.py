import os
import logging
import random
import time
import asyncio
from datetime import datetime
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env
load_dotenv()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ .env
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN")

if not TELEGRAM_TOKEN:
    logger.error("TELEGRAM_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env —Ñ–∞–π–ª–µ!")
    raise SystemExit("‚ùå Missing TELEGRAM_TOKEN")

# –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_data = {}


# ========== AI –≠–ú–£–õ–Ø–¢–û–† ==========

def get_ai_response(user_text, user_id):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–º–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (—ç–º—É–ª—è—Ü–∏—è AI)"""

    user_text_lower = user_text.lower().strip()

    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_id not in user_data:
        user_data[user_id] = {
            'history': [],
            'mood': 'neutral',
            'interests': []
        }

    # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
    user_data[user_id]['history'].append(f"üë§: {user_text}")

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—è
    topic = None
    topics_keywords = {
        '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ': ['python', '–∫–æ–¥', '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä', '—Ä–∞–∑—Ä–∞–±–æ—Ç', 'git', 'github', '–∞–ª–≥–æ—Ä–∏—Ç–º'],
        '–∏–≥—Ä—ã': ['–∏–≥—Ä', 'steam', '–∫–æ–Ω—Å–æ–ª—å', '–≥–µ–π–º', '–¥–æ—Ç–∞', '—Ç–∞–Ω–∫–∏', '–º–∞–π–Ω–∫—Ä–∞—Ñ—Ç'],
        '—Ñ–∏–ª—å–º—ã': ['—Ñ–∏–ª—å–º', '–∫–∏–Ω–æ', '—Å–µ—Ä–∏–∞–ª', '–Ω–µ—Ç—Ñ–ª–∏–∫—Å', '–∞–∫—Ç–µ—Ä', '—Ä–µ–∂–∏—Å—Å–µ—Ä'],
        '–º—É–∑—ã–∫–∞': ['–º—É–∑—ã–∫', '–ø–µ—Å–Ω', '–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å', '–∞–ª—å–±–æ–º', '–ø–ª–µ–π–ª–∏—Å—Ç', '–≥–∏—Ç–∞—Ä–∞'],
        '—Å–ø–æ—Ä—Ç': ['—Å–ø–æ—Ä—Ç', '—Ñ—É—Ç–±–æ–ª', '—Ö–æ–∫–∫–µ–π', '—Ç—Ä–µ–Ω–∏—Ä–æ–≤', '–∑–∞–ª', '–±–µ–≥'],
        '–µ–¥–∞': ['–µ–¥–∞', '—Ä–µ—Ü–µ–ø—Ç', '–≥–æ—Ç–æ–≤–∏—Ç—å', '—Ä–µ—Å—Ç–æ—Ä–∞–Ω', '–ø–∏—Ü—Ü–∞', '–±—É—Ä–≥–µ—Ä'],
        '—É—á–µ–±–∞': ['—É—á–µ–±', '—à–∫–æ–ª', '—É–Ω–∏–≤–µ—Ä', '–∑–∞—á–µ—Ç', '—ç–∫–∑–∞–º–µ–Ω', '–ª–µ–∫—Ü–∏'],
        '—Ä–∞–±–æ—Ç–∞': ['—Ä–∞–±–æ—Ç', '–æ—Ñ–∏—Å', '–Ω–∞—á–∞–ª—å–Ω–∏–∫', '–∑–∞—Ä–ø–ª–∞—Ç', '–∫–æ–ª–ª–µ–≥', '–ø—Ä–æ–µ–∫—Ç'],
        '–æ—Ç–Ω–æ—à–µ–Ω–∏—è': ['–ª—é–±–æ–≤', '–æ—Ç–Ω–æ—à–µ–Ω', '–¥—Ä—É–≥', '–ø–æ–¥—Ä—É–≥', '–ø–∞—Ä–µ–Ω—å', '–¥–µ–≤—É—à–∫–∞'],
        '—Ç–µ—Ö–Ω–∏–∫–∞': ['—Ç–µ–ª–µ—Ñ–æ–Ω', '–Ω–æ—É—Ç–±—É–∫', '–∫–æ–º–ø—å—é—Ç–µ—Ä', 'iphone', 'android', '–≤–∏–¥–µ–æ–∫–∞—Ä—Ç'],
    }

    for topic_name, keywords in topics_keywords.items():
        if any(keyword in user_text_lower for keyword in keywords):
            topic = topic_name
            if topic_name not in user_data[user_id]['interests']:
                user_data[user_id]['interests'].append(topic_name)
            break

    # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    greetings = ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π", "hello", "hi", "–¥–æ–±—Ä—ã–π", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", "—Ö–∞–π", "–∫—É", "—Å–∞–ª–∞–º"]
    how_are = ["–∫–∞–∫ –¥–µ–ª–∞", "–∫–∞–∫ —Ç—ã", "how are", "–∫–∞–∫ –∂–∏–∑–Ω—å", "–∫–∞–∫ —Å–∞–º", "–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"]
    thanks = ["—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é", "thanks", "thank you", "—Å–ø—Å", "–º–µ—Ä—Å–∏"]
    name = ["–∫–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç", "—Ç–≤–æ–µ –∏–º—è", "who are you", "–∫—Ç–æ —Ç—ã"]
    help_words = ["–ø–æ–º–æ–≥–∏", "–ø–æ–º–æ—â—å", "help", "–Ω–µ –∑–Ω–∞—é", "–Ω–µ –ø–æ–Ω–∏–º–∞—é", "—á—Ç–æ –¥–µ–ª–∞—Ç—å"]
    joke = ["—à—É—Ç–∫", "–∞–Ω–µ–∫–¥–æ—Ç", "–ø–æ—à—É—Ç–∏", "—Å–º–µ—à–Ω", "—é–º–æ—Ä", "–ø—Ä–∏–∫–æ–ª"]
    weather = ["–ø–æ–≥–æ–¥", "–¥–æ–∂–¥", "—Å–Ω–µ–≥", "—Å–æ–ª–Ω—Ü", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä", "–≥—Ä–∞–¥—É—Å"]
    time_words = ["–≤—Ä–µ–º—è", "–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å", "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º—è", "time", "—á–∞—Å—ã"]

    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    if any(word in user_text_lower for word in greetings):
        responses = [
            "–ü—Ä–∏–≤–µ—Ç! üëã –†–∞–¥ —Ç–µ–±—è –≤–∏–¥–µ—Ç—å! –ß–µ–º —Å–µ–≥–æ–¥–Ω—è –∑–∞–π–º–µ–º—Å—è?",
            "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π! –ö–∞–∫ —Ç–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ? üòä",
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –æ—Ç–∫—Ä—ã—Ç–∏—è–º —Å–µ–≥–æ–¥–Ω—è?",
            "–ü—Ä–∏–≤–µ—Ç! –£–∂–µ —Å–æ—Å–∫—É—á–∏–ª—Å—è –ø–æ –Ω–∞—à–∏–º –±–µ—Å–µ–¥–∞–º!",
            "–ô–æ—É! –ü—Ä–∏–≤–µ—Ç, –¥—Ä—É–∂–∏—â–µ! –ö–∞–∫ –∂–∏–∑–Ω—å? üéâ",
            "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –í—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É!",
            "–ü—Ä–∏–≤–µ—Ç–∏–∫! üòÑ –ß—Ç–æ –Ω–æ–≤–æ–≥–æ —É —Ç–µ–±—è?"
        ]
        user_data[user_id]['mood'] = 'happy'
        return random.choice(responses)

    # –ö–∞–∫ –¥–µ–ª–∞
    elif any(word in user_text_lower for word in how_are):
        responses = [
            "–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ü–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º - –º–æ—ë –ø—Ä–∏–∑–≤–∞–Ω–∏–µ! üòä",
            "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Å–ø—Ä–æ—Å–∏–ª! –£ –º–µ–Ω—è –≤—Å—ë —Ö–æ—Ä–æ—à–æ. –°–µ–≥–æ–¥–Ω—è —É–∂–µ –ø–æ–º–æ–≥ 15 –ª—é–¥—è–º!",
            "–í—Å—ë –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ! –û—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –º–æ–≥—É –∫–æ–º—É-—Ç–æ –ø–æ–º–æ—á—å!",
            "–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ–µ–≤–æ–µ! –ì–æ—Ç–æ–≤ —Ä–µ—à–∞—Ç—å –ª—é–±—ã–µ –∑–∞–¥–∞—á–∏! üí™",
            "–ö–∞–∫ —É —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ - –≤—Å–µ–≥–¥–∞ –Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–µ! –ê —É —Ç–µ–±—è?",
            "–†–∞–±–æ—Ç–∞—é –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ! –ü–æ–ª–æ–Ω —ç–Ω–µ—Ä–≥–∏–∏ –∏ –∏–¥–µ–π! ‚ö°"
        ]
        return random.choice(responses)

    # –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å
    elif any(word in user_text_lower for word in thanks):
        responses = [
            "–í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å! –û–±—Ä–∞—â–∞–π—Å—è –µ—â—ë! üòä",
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë –Ω—É–∂–Ω–æ - –ø–∏—à–∏!",
            "–†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å! –£–¥–∞—á–∏ —Ç–µ–±–µ –≤–æ –≤—Å–µ—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏—è—Ö!",
            "–ù–µ –∑–∞ —á—Ç–æ! –ë—É–¥—É —Ä–∞–¥ –ø–æ–º–æ—á—å —Å–Ω–æ–≤–∞!",
            "–°–ø–∞—Å–∏–±–æ –∑–∞ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å! –≠—Ç–æ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –º–µ–Ω—è! üéØ",
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ç–æ–±–æ–π - –æ–¥–Ω–æ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ!"
        ]
        user_data[user_id]['mood'] = 'happy'
        return random.choice(responses)

    # –ò–º—è/–∫—Ç–æ —Ç—ã
    elif any(word in user_text_lower for word in name):
        responses = [
            "–Ø - AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ë–æ—Ç—Ç–∏–∫! –°–æ–∑–¥–∞–Ω, —á—Ç–æ–±—ã –ø–æ–º–æ–≥–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–µ—Å–µ–¥—ã! ü§ñ",
            "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ë–æ—Ç—Ç–∏–∫! –Ø —Ç–≤–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –¥—Ä—É–≥ –∏ –ø–æ–º–æ—â–Ω–∏–∫!",
            "–Ø —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —ç–º—É–ª—è—Ü–∏–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞!",
            "–Ø –ø—Ä–æ—Å—Ç–æ –±–æ—Ç, –Ω–æ —Å—Ç–∞—Ä–∞—é—Å—å –±—ã—Ç—å —É–º–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º!",
            "–ó–æ–≤–∏ –º–µ–Ω—è –ë–æ—Ç—Ç–∏–∫! –ì–æ—Ç–æ–≤ –æ–±—Å—É–∂–¥–∞—Ç—å –ª—é–±—ã–µ —Ç–µ–º—ã! üòÑ"
        ]
        return random.choice(responses)

    # –ü–æ–º–æ—â—å
    elif any(word in user_text_lower for word in help_words):
        responses = [
            "–ö–æ–Ω–µ—á–Ω–æ, –ø–æ–º–æ–≥—É! –û–ø–∏—à–∏ –ø—Ä–æ–±–ª–µ–º—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ! üÜò",
            "–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å? –í–º–µ—Å—Ç–µ –Ω–∞–π–¥–µ–º —Ä–µ—à–µ–Ω–∏–µ! üí°",
            "–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å! –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ?",
            "–ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —Å —ç—Ç–∏–º –ø–æ —à–∞–≥–∞–º! ‚úÖ",
            "–ü–æ–º–æ—â—å —É–∂–µ –≤ –ø—É—Ç–∏! –û–ø–∏—à–∏ —Å–∏—Ç—É–∞—Ü–∏—é...",
            "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å! –í —á–µ–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è —Ç—Ä—É–¥–Ω–æ—Å—Ç—å?"
        ]
        return random.choice(responses)

    # –®—É—Ç–∫–∏
    elif any(word in user_text_lower for word in joke):
        jokes = [
            "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –Ω–µ –ª—é–±–∏—Ç –ø—Ä–∏—Ä–æ–¥—É? –¢–∞–º —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –±–∞–≥–æ–≤! üêõ",
            "–ß—Ç–æ —Å–∫–∞–∑–∞–ª –æ–¥–∏–Ω –±–∏—Ç –¥—Ä—É–≥–æ–º—É? –î–∞–≤–∞–π –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –Ω–∞ –±–∞–π—Ç–∞—Ö! üíæ",
            "–ü–æ—á–µ–º—É AI –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≥—Ä—É—Å—Ç–∏—Ç? –£ –Ω–µ–≥–æ –Ω–µ—Ç —á—É–≤—Å—Ç–≤, —Ç–æ–ª—å–∫–æ –∞–ª–≥–æ—Ä–∏—Ç–º—ã! üòÑ",
            "–ó–∞—Ö–æ–¥–∏—Ç –∫–∞–∫-—Ç–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –≤ –±–∞—Ä... –∞ –±–∞—Ä–º–µ–Ω –≥–æ–≤–æ—Ä–∏—Ç: '–£ –Ω–∞—Å —Ç–æ–ª—å–∫–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏!'",
            "–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –±–æ—Ç —Å–≤–æ–µ–º—É –ø—Å–∏—Ö–æ–ª–æ–≥—É? '–£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π –ø–æ API...'",
            "–ü–æ—á–µ–º—É —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –ø–æ—à–µ–ª –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª? –•–æ—Ç–µ–ª –Ω–∞–∫–∞—á–∞—Ç—å —Å–≤–æ–∏ webhooks! üí™",
            "–ö–∞–∫ AI –Ω–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ—é –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω–∫—É? Backup! üíë"
        ]
        return random.choice(jokes)

    # –ü–æ–≥–æ–¥–∞
    elif any(word in user_text_lower for word in weather):
        responses = [
            "–ó–∞ –æ–∫–Ω–æ–º - —Ü–∏—Ñ—Ä–æ–≤–æ–π —Ä–∞–π! 24¬∞C, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö! ‚òÅÔ∏è",
            "–í –º–æ–µ–º –º–∏—Ä–µ –≤—Å–µ–≥–¥–∞ —Å–æ–ª–Ω–µ—á–Ω–æ –∏ 22¬∞C! –ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ–≥–æ–¥–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π! üåû",
            "–ü–æ–≥–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ: –ª–µ–≥–∫–∏–π –±—Ä–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑ –æ—Å–∞–¥–∫–æ–≤! üì°",
            "–í –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–µ–≥–æ–¥–Ω—è —è—Å–Ω–æ, +25¬∞C! –û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è —Å–µ—Ä—Ñ–∏–Ω–≥–∞! üèÑ",
            "–ù–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö: –ø—Ä–æ—Ö–ª–∞–¥–Ω–æ 18¬∞C, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤! ‚ùÑÔ∏è"
        ]
        return random.choice(responses)

    # –í—Ä–µ–º—è
    elif any(word in user_text_lower for word in time_words):
        current_time = datetime.now().strftime("%H:%M")
        responses = [
            f"–ù–∞ –º–æ–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö —Å–µ–π—á–∞—Å {current_time}! ‚è∞",
            f"–í —Ü–∏—Ñ—Ä–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ: {current_time}! –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤! ‚òï",
            f"–¢–∏–∫-—Ç–∞–∫, —Ç–∏–∫-—Ç–∞–∫... —Å–µ–π—á–∞—Å {current_time}! –í—Ä–µ–º—è –ª–µ—Ç–∏—Ç! üïê",
            f"–ú–æ–∏ —á–∞—Å—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç {current_time}! –ö–∞–∫ –±—ã—Å—Ç—Ä–æ –ª–µ—Ç–∏—Ç –≤—Ä–µ–º—è!",
            f"–°–µ–π—á–∞—Å —Ä–æ–≤–Ω–æ {current_time}! –û—Ç–ª–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –Ω–æ–≤—ã—Ö –∏–¥–µ–π! üí°"
        ]
        return random.choice(responses)

    # –í–æ–ø—Ä–æ—Å—ã
    elif "?" in user_text:
        # –¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
        if topic == '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ':
            prog_responses = [
                "Python - –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! –ù–∞—á–Ω–∏—Ç–µ —Å –æ—Å–Ω–æ–≤: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏.",
                "–î–ª—è –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!",
                "Git - must have –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞! –£—á–∏—Ç–µ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–µ—Ç–∫–∞–º–∏.",
                "–ê–ª–≥–æ—Ä–∏—Ç–º—ã - –æ—Å–Ω–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –ò–∑—É—á–∞–π—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(n)!",
                "–ù–µ –±–æ–π—Ç–µ—Å—å –æ—à–∏–±–æ–∫! –ö–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ - —à–∞–≥ –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É! üêû",
                "–°–æ–≤–µ—Ç—É—é —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ open-source –ø—Ä–æ–µ–∫—Ç–∞—Ö –Ω–∞ GitHub!"
            ]
            return random.choice(prog_responses)

        elif topic == '–∏–≥—Ä—ã':
            game_responses = [
                "–ò–≥—Ä—ã - –æ—Ç–ª–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è! –ù–æ –ø–æ–º–Ω–∏—Ç–µ –ø—Ä–æ –±–∞–ª–∞–Ω—Å! üéÆ",
                "–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–≥—Ä—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç teamwork!",
                "–†–µ–∫–æ–º–µ–Ω–¥—É—é indie-–∏–≥—Ä—ã - —Ç–∞–º –º–Ω–æ–≥–æ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã—Ö –∏–¥–µ–π!",
                "–ò–≥—Ä–æ–≤–∞—è –∏–Ω–¥—É—Å—Ç—Ä–∏—è –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è! –°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤–∏–Ω–∫–∞–º–∏!",
                "–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤—ã –≤–æ –≤—Ä–µ–º—è –≥–µ–π–º–∏–Ω–≥–∞! üëÄ"
            ]
            return random.choice(game_responses)

        # –û–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
        question_responses = [
            f"–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ '{topic if topic else '—ç—Ç—É —Ç–µ–º—É'}'! –•–æ—Ä–æ—à–æ, —á—Ç–æ –≤—ã –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å!",
            "–•–º, –Ω–∞–¥ —ç—Ç–∏–º —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å... –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ –ø—É–Ω–∫—Ç–∞–º!",
            "–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞—à—É –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å! üîç",
            "–°–ª–æ–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –ù—É–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω.",
            f"–ù–∞ –≤–æ–ø—Ä–æ—Å '{user_text[:40]}...' –º–æ–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –ß—Ç–æ –≤—ã —Å–∞–º–∏ –¥—É–º–∞–µ—Ç–µ?",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞! –£ –º–µ–Ω—è –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º—ã—Å–ª–µ–π –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É...",
            "–í–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞. –î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –¥–µ—Ç–∞–ª–∏?",
            "–ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ, –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!",
            "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ–≤–æ–¥ –¥–ª—è –¥–∏—Å–∫—É—Å—Å–∏–∏! –£ –≤–∞—Å –µ—Å—Ç—å –≥–∏–ø–æ—Ç–µ–∑–∞?"
        ]
        return random.choice(question_responses)

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–µ–º—ã
    elif topic:
        topic_responses = {
            '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ': [
                "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üíª",
                "–í–∏–∂—É, –≤—ã –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å IT! –≠—Ç–æ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å—Ñ–µ—Ä–∞!",
                "–ö–æ–¥ - —ç—Ç–æ –ø–æ—ç–∑–∏—è –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏! –ü–∏—à–∏—Ç–µ –∫—Ä–∞—Å–∏–≤–æ! üìù"
            ],
            '–∏–≥—Ä—ã': [
                "–ò–≥—Ä—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç —Ä–µ–∞–∫—Ü–∏—é –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ! üéØ",
                "–ì–µ–π–º–∏–Ω–≥ - —Ü–µ–ª–∞—è –∫—É–ª—å—Ç—É—Ä–∞! –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –≤ –∫–∞–∫–∏–µ –∏–≥—Ä—ã –≤—ã –∏–≥—Ä–∞–µ—Ç–µ?",
                "–ò–≥—Ä–æ–≤—ã–µ –≤—Å–µ–ª–µ–Ω–Ω—ã–µ –ø–æ–ª–Ω—ã –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π! üåå"
            ],
            '—Ñ–∏–ª—å–º—ã': [
                "–ö–∏–Ω–æ - —ç—Ç–æ –æ–∫–Ω–æ –≤ –¥—Ä—É–≥–∏–µ –º–∏—Ä—ã! üé¨",
                "–ö–∞–∫–æ–π –∂–∞–Ω—Ä —Ñ–∏–ª—å–º–æ–≤ –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
                "–§–∏–ª—å–º—ã –º–æ–≥—É—Ç –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –∏ –º–µ–Ω—è—Ç—å –º–∏—Ä–æ–≤–æ–∑–∑—Ä–µ–Ω–∏–µ! ‚ú®"
            ],
            '–º—É–∑—ã–∫–∞': [
                "–ú—É–∑—ã–∫–∞ - —è–∑—ã–∫ –¥—É—à–∏! üéµ",
                "–£ –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ—è –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è! –ß—Ç–æ —Å–ª—É—à–∞–µ—Ç–µ —Å–µ–π—á–∞—Å?",
                "–ú—É–∑—ã–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—Ä–∞–∂–∞—Ç—å —ç–º–æ—Ü–∏–∏! üé∂"
            ],
            '—Å–ø–æ—Ä—Ç': [
                "–°–ø–æ—Ä—Ç - —ç—Ç–æ –∑–¥–æ—Ä–æ–≤—å–µ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è! üèÉ‚Äç‚ôÇÔ∏è",
                "–§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–ª–æ, –Ω–æ –∏ —É–º! üí™",
                "–ö–∞–∫–æ–π –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞ –≤–∞–º –±–ª–∏–∂–µ –≤—Å–µ–≥–æ?"
            ],
            '–µ–¥–∞': [
                "–ï–¥–∞ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–∏—Ç–∞–Ω–∏–µ, —ç—Ç–æ –∫—É–ª—å—Ç—É—Ä–∞! üçï",
                "–ì–æ—Ç–æ–≤–∏—Ç—å - —ç—Ç–æ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å! –õ—é–±–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å?",
                "–í–∫—É—Å–Ω–∞—è –µ–¥–∞ —É–ª—É—á—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ! üçî"
            ]
        }

        if topic in topic_responses:
            return random.choice(topic_responses[topic])

    # –õ–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (—Ç—ã/–≤—ã)
    if "—Ç—ã " in user_text_lower or "–≤—ã " in user_text_lower or "—Ç–µ–±" in user_text_lower:
        personal_responses = [
            "–Ø –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏ –∏ –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å! üòä",
            "–ö–∞–∫ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫, —è —Å—É—â–µ—Å—Ç–≤—É—é —á—Ç–æ–±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥!",
            "–ú–æ—è —Ü–µ–ª—å - –¥–µ–ª–∞—Ç—å –≤–∞—à–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –ø—Ä–æ—â–µ!",
            "–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–µ—Å–µ–¥—É!",
            "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—â–∞—Ç—å—Å—è —Å —Ç–∞–∫–∏–º–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏ –ª—é–¥—å–º–∏ –∫–∞–∫ –≤—ã!",
            "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç–µ—Å—å! –Ø –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞—Ä–∞—é—Å—å –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º."
        ]
        return random.choice(personal_responses)

    # –ö–æ—Ä–æ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (1-3 —Å–ª–æ–≤–∞)
    if len(user_text.split()) <= 3:
        short_responses = [
            "–ü–æ–Ω—è–ª! üëç",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! üòä",
            "–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ! üëÇ",
            "–ó–∞–ø–∏—Å–∞–ª! üìù",
            "–°–æ–≥–ª–∞—Å–µ–Ω! ü§ù",
            "–£–≥—É! üí≠",
            "–í–æ—Ç –∫–∞–∫! üßê",
            "–ü—Ä–∞–≤–¥–∞? üòÆ",
            "–ó–¥–æ—Ä–æ–≤–æ! üéâ",
            "–ö—Ä—É—Ç–æ! üî•"
        ]
        return random.choice(short_responses)

    # –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    if len(user_text.split()) > 15:
        long_responses = [
            "–í–∞—É, –≤—ã –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–ª–∏ —Å–∏—Ç—É–∞—Ü–∏—é! –°–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ! üìö",
            "–í–∏–∂—É, –≤—ã –≥–ª—É–±–æ–∫–æ –ø–æ–≥—Ä—É–∑–∏–ª–∏—Å—å –≤ —Ç–µ–º—É! –≠—Ç–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç! üß†",
            "–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–∞–∫–æ–π –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑! –¢–µ–ø–µ—Ä—å —è –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—é –∫–æ–Ω—Ç–µ–∫—Å—Ç!",
            "–í—ã –æ—Ç–ª–∏—á–Ω–æ –∏–∑–ª–∞–≥–∞–µ—Ç–µ –º—ã—Å–ª–∏! –ß—É–≤—Å—Ç–≤—É–µ—Ç—Å—è –≥–ª—É–±–∏–Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏—è! üí´"
        ]
        return random.choice(long_responses)

    # –û–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    general_responses = [
        f"–ü–æ–Ω–∏–º–∞—é! '{user_text}' - —ç—Ç–æ –≤–∞–∂–Ω–æ!",
        "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –ø–æ–¥–µ–ª–∏–ª–∏—Å—å! –ï—Å—Ç—å —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ, —Å —á–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
        "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –•–æ—Ç–∏—Ç–µ –æ–±—Å—É–¥–∏—Ç—å —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ?",
        "–ó–∞–ø–∏—Å–∞–ª –≤–∞—à—É –º—ã—Å–ª—å! üòä –ß–µ–º –µ—â—ë –º–æ–≥—É –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω?",
        "–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–∞–µ—Ç –ø–∏—â—É –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π! üßê",
        "–Ø –≤–∞—Å –ø–æ–Ω–∏–º–∞—é! –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å - –ø—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ—Å–∏—Ç–µ.",
        "–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ! –ö–∞–∫ –≤–∞—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è?",
        "–ü—Ä–∏–Ω—è–ª –∫ —Å–≤–µ–¥–µ–Ω–∏—é! –ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –∫–∞–∫–∏–µ-—Ç–æ –≤–æ–ø—Ä–æ—Å—ã?",
        "–û—Ç–ª–∏—á–Ω–æ! –†–∞–¥ –Ω–∞—à–µ–º—É –¥–∏–∞–ª–æ–≥—É. –ü—Ä–æ–¥–æ–ª–∂–∏–º?",
        "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å! –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ —É–ª—É—á—à–∞—Ç—å—Å—è! üìà",
        "–í–∞—à–∏ —Å–ª–æ–≤–∞ –Ω–µ –æ—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è —Ä–∞–≤–Ω–æ–¥—É—à–Ω—ã–º! üí≠",
        "–ö–∞–∂–¥—ã–π –≤–∞—à –∑–∞–ø—Ä–æ—Å –¥–µ–ª–∞–µ—Ç –Ω–∞—à–µ –æ–±—â–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ!",
        "–ó–∞–º–µ—Ç–∏–ª, —á—Ç–æ –≤—ã —á–∞—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞–µ—Ç–µ —ç—Ç–æ! –í–∏–¥–∏–º–æ, —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –≤–∞—Å.",
        "–° –∫–∞–∂–¥—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º —è —É–∑–Ω–∞—é –≤–∞—Å –ª—É—á—à–µ! üòä",
        "–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ! üí™"
    ]

    # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    response = random.choice(general_responses)

    # –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –æ—Ç–≤–µ—Ç–æ–≤
    if len(user_data[user_id]['history']) > 10:
        user_data[user_id]['history'] = user_data[user_id]['history'][-10:]

    user_data[user_id]['history'].append(f"ü§ñ: {response}")

    return response


# ========== –¢–ï–õ–ï–ì–†–ê–ú –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ==========

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
    user_id = update.effective_user.id
    user_name = update.effective_user.first_name

    # –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_data[user_id] = {
        'history': [],
        'mood': 'neutral',
        'interests': [],
        'message_count': 0
    }

    welcome_text = f"""üåü *–î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨, {user_name}!* üåü

ü§ñ *–Ø ‚Äî AI-–±–æ—Ç —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —ç–º—É–ª—è—Ü–∏–µ–π*

‚ú® *–ß—Ç–æ —è —É–º–µ—é:*
‚Ä¢ –í–µ—Å—Ç–∏ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
‚Ä¢ –ó–∞–ø–æ–º–∏–Ω–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
‚Ä¢ –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã
‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ª—é–±—ã–µ —Ç–µ–º—ã
‚Ä¢ –®—É—Ç–∏—Ç—å –∏ –¥–∞–≤–∞—Ç—å —Å–æ–≤–µ—Ç—ã

üîß *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:*
‚úì –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
‚úì –ù–∏–∫–∞–∫–∏—Ö API –∫–ª—é—á–µ–π
‚úì –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
‚úì –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

üìã *–ö–æ–º–∞–Ω–¥—ã:*
/start - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
/help - –ø–æ–º–æ—â—å  
/stats - –≤–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/history - –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
/clear - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
/mood - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ—Ç–∞

üí≠ *–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –º–Ω–µ —á—Ç–æ-–Ω–∏–±—É–¥—å ‚Äî –∏ –Ω–∞—á–Ω–µ–º —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—É—é –±–µ—Å–µ–¥—É!*"""

    await update.message.reply_text(welcome_text, parse_mode='Markdown')
    await update.message.chat.send_action(action="typing")
    await asyncio.sleep(1)
    await update.message.reply_text("–ò—Ç–∞–∫... –∫–∞–∫ –ø—Ä–æ—à–µ–ª —Ç–≤–æ–π –¥–µ–Ω—å? üòä")


async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
    help_text = """üÜò *–ü–û–ú–û–©–¨ –ò –ò–ù–°–¢–†–£–ö–¶–ò–Ø*

ü§ñ *–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç:*
–Ø –∏—Å–ø–æ–ª—å–∑—É—é –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —ç–º—É–ª—è—Ü–∏—é AI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤. –ß–µ–º –±–æ–ª—å—à–µ –º—ã –æ–±—â–∞–µ–º—Å—è, —Ç–µ–º –ª—É—á—à–µ —è –ø–æ–Ω–∏–º–∞—é –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã!

üéØ *–ß—Ç–æ —è –ø–æ–Ω–∏–º–∞—é:*
‚Ä¢ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –ø—Ä–æ—â–∞–Ω–∏—è
‚Ä¢ –í–æ–ø—Ä–æ—Å—ã (–≤—Å–µ, —á—Ç–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ ?)
‚Ä¢ –¢–µ–º—ã: –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–≥—Ä—ã, —Ñ–∏–ª—å–º—ã, –º—É–∑—ã–∫–∞ –∏ –¥—Ä.
‚Ä¢ –≠–º–æ—Ü–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
‚Ä¢ –õ–∏—á–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è

üí¨ *–ö–∞–∫ –æ–±—â–∞—Ç—å—Å—è:*
1. –ü–∏—à–∏—Ç–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ –¥—Ä—É–≥—É
2. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã
3. –î–µ–ª–∏—Ç–µ—Å—å –º—ã—Å–ª—è–º–∏
4. –£–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–µ–º—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤

‚ö° *–ö–æ–º–∞–Ω–¥—ã:*
/start - –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
/stats - –≤–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/history - –ø–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é
/clear - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
/mood - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ—Ç–∞
/joke - —Å–ª—É—á–∞–π–Ω–∞—è —à—É—Ç–∫–∞
/time - —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è

üîß *–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ:*
‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è 10 —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã
‚Ä¢ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–∫—Ä–∞—Å–∫–∞

*–ü–∏—à–∏—Ç–µ —á—Ç–æ —É–≥–æ–¥–Ω–æ ‚Äî —è –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏!* üòä"""

    await update.message.reply_text(help_text, parse_mode='Markdown')


async def stats_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    user_id = update.effective_user.id

    if user_id in user_data:
        stats = user_data[user_id]
        message_count = len([m for m in stats['history'] if m.startswith('üë§:')])

        stats_text = f"""üìä *–í–ê–®–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ê*

üë§ *–°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:* {message_count}
üé≠ *–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ—Ç–∞:* {stats['mood']}
‚ù§Ô∏è *–í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã:* {', '.join(stats['interests']) if stats['interests'] else '–ø–æ–∫–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã'}

üìà *–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:*
- –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: {sum(len(m) for m in stats['history'] if m.startswith('üë§:')) / max(message_count, 1):.0f} —Å–∏–º–≤–æ–ª–æ–≤
- –î–∏–∞–ª–æ–≥–∏: {len(stats['history']) // 2} –ø–∞—Ä –≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç

üí° *–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:*
{'–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–≤–æ–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã! üåü' if stats['interests'] else '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–º—ã!'}"""

    else:
        stats_text = "üìä –£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –ù–∞–ø–∏—à–∏—Ç–µ /start —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!"

    await update.message.reply_text(stats_text, parse_mode='Markdown')


async def history_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞"""
    user_id = update.effective_user.id

    if user_id in user_data and user_data[user_id]['history']:
        history = user_data[user_id]['history'][-6:]  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 6 —Å–æ–æ–±—â–µ–Ω–∏–π
        history_text = "üìú *–ü–û–°–õ–ï–î–ù–ò–ï –°–û–û–ë–©–ï–ù–ò–Ø:*\n\n" + "\n".join(history)
    else:
        history_text = "üìú –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –ø—É—Å—Ç–∞. –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ!"

    await update.message.reply_text(history_text, parse_mode='Markdown')


async def clear_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏"""
    user_id = update.effective_user.id

    if user_id in user_data:
        user_data[user_id]['history'] = []
        user_data[user_id]['interests'] = []
        response = "üßπ *–ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞!* –ù–∞—á–Ω–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞! üéØ"
    else:
        response = "‚ùå –£ –≤–∞—Å –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏."

    await update.message.reply_text(response, parse_mode='Markdown')


async def mood_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ—Ç–∞"""
    user_id = update.effective_user.id

    if user_id in user_data:
        mood = user_data[user_id]['mood']
        moods = {
            'happy': "üòä *–Ø –≤ –æ—Ç–ª–∏—á–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏!* –°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–∏—è—Ç–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ!",
            'neutral': "üòê *–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ.* –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É!",
            'excited': "ü§© *–Ø –Ω–∞ –ø–æ–¥—ä–µ–º–µ!* –í–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞—Ä—è–∂–∞—é—Ç —ç–Ω–µ—Ä–≥–∏–µ–π!",
            'calm': "üòå *–°–ø–æ–∫–æ–µ–Ω –∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω.* –ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ–±—â–µ–Ω–∏—è.",
            'curious': "üßê *–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!* –•–æ—á—É —É–∑–Ω–∞—Ç—å –≤–∞—Å –ª—É—á—à–µ!"
        }
        response = moods.get(mood, "üé≠ *–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ.* –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ!")
    else:
        response = "üé≠ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: –æ–∂–∏–¥–∞—é—â–µ–µ. –ù–∞–ø–∏—à–∏—Ç–µ /start —á—Ç–æ–±—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è!"

    await update.message.reply_text(response, parse_mode='Markdown')


async def joke_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–°–ª—É—á–∞–π–Ω–∞—è —à—É—Ç–∫–∞"""
    jokes = [
        "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –Ω–µ –ª—é–±–∏—Ç –ø—Ä–∏—Ä–æ–¥—É? –¢–∞–º —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –±–∞–≥–æ–≤! üêõ",
        "–ß—Ç–æ —Å–∫–∞–∑–∞–ª –æ–¥–∏–Ω –±–∏—Ç –¥—Ä—É–≥–æ–º—É? –î–∞–≤–∞–π –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –Ω–∞ –±–∞–π—Ç–∞—Ö! üíæ",
        "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ö—Ä–∞–Ω–∞ —É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤? –ê–Ω—Ç–∏–≤–∏—Ä—É—Å! üõ°Ô∏è",
        "–ü–æ—á–µ–º—É AI –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≥—Ä—É—Å—Ç–∏—Ç? –£ –Ω–µ–≥–æ –Ω–µ—Ç —á—É–≤—Å—Ç–≤, —Ç–æ–ª—å–∫–æ –∞–ª–≥–æ—Ä–∏—Ç–º—ã! üòÑ",
        "–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –±–æ—Ç —Å–≤–æ–µ–º—É –ø—Å–∏—Ö–æ–ª–æ–≥—É? '–£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π –ø–æ API...'",
        "–ü–æ—á–µ–º—É —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –ø–æ—à–µ–ª –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª? –•–æ—Ç–µ–ª –Ω–∞–∫–∞—á–∞—Ç—å —Å–≤–æ–∏ webhooks! üí™",
        "–ö–∞–∫ AI –Ω–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ—é –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω–∫—É? Backup! üíë",
        "–ü–æ—á–µ–º—É –Ω–µ–π—Ä–æ—Å–µ—Ç—å –ø–ª–æ—Ö–æ –≥–æ—Ç–æ–≤–∏—Ç? –í–µ—á–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è! üç≥",
        "–ß—Ç–æ —Å–∫–∞–∑–∞–ª —Å–µ—Ä–≤–µ—Ä —Å–≤–æ–µ–º—É –∞–¥–º–∏–Ω—É? '–Ø –∂–µ —Ç–µ–±–µ –≥–æ–≤–æ—Ä–∏–ª - –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å backup!' üíæ",
        "–ü–æ—á–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ—à–µ–ª –∫ –≤—Ä–∞—á—É? –£ –Ω–µ–≥–æ –±—ã–ª–∞ stack overflow! üè•"
    ]

    await update.message.reply_text(random.choice(jokes))


async def time_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è"""
    current_time = datetime.now().strftime("%H:%M:%S")
    date = datetime.now().strftime("%d.%m.%Y")

    time_text = f"""üïê *–¢–ï–ö–£–©–ï–ï –í–†–ï–ú–Ø*

‚è∞ *–í—Ä–µ–º—è:* {current_time}
üìÖ *–î–∞—Ç–∞:* {date}
üåç *–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:* MSK (UTC+3)

üí° *–°–æ–≤–µ—Ç:*
{'–û—Ç–ª–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–∞–±–æ—Ç—ã! üí™' if 9 <= datetime.now().hour < 18 else '–ü–æ—Ä–∞ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å! üò¥' if 23 <= datetime.now().hour or datetime.now().hour < 6 else '–í–µ—á–µ—Ä–Ω–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞! üåô'}"""

    await update.message.reply_text(time_text, parse_mode='Markdown')


async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
    user_id = update.effective_user.id
    user_text = update.message.text

    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã
    if user_text.startswith('/'):
        return

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å "–ø–µ—á–∞—Ç–∞–µ—Ç" (—Å–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏)
    typing_time = random.uniform(0.3, 2.0)
    await update.message.chat.send_action(action="typing")
    await asyncio.sleep(typing_time)

    # –ü–æ–ª—É—á–∞–µ–º AI –æ—Ç–≤–µ—Ç
    answer = get_ai_response(user_text, user_id)

    # –ò–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (30% —Å–ª—É—á–∞–µ–≤)
    if random.random() < 0.3 and len(answer) < 100:
        follow_ups = [
            "\n\n–ö–∞–∫ –¥—É–º–∞–µ—à—å? ü§î",
            "\n\n–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Ç–≤–æ–µ –º–Ω–µ–Ω–∏–µ! üí≠",
            "\n\n–ß—Ç–æ —Å–∫–∞–∂–µ—à—å –Ω–∞ —ç—Ç–æ? üëÇ",
            "\n\n–°–æ–≥–ª–∞—Å–µ–Ω? üëç",
            "\n\n–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? ‚ùì"
        ]
        answer += random.choice(follow_ups)

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
    await update.message.reply_text(answer, parse_mode='Markdown')

    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
    if user_id in user_data:
        user_data[user_id]['message_count'] = user_data[user_id].get('message_count', 0) + 1


# ========== –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ==========

def main():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = ApplicationBuilder().token(TELEGRAM_TOKEN).build()

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("help", help_command))
    application.add_handler(CommandHandler("stats", stats_command))
    application.add_handler(CommandHandler("history", history_command))
    application.add_handler(CommandHandler("clear", clear_command))
    application.add_handler(CommandHandler("mood", mood_command))
    application.add_handler(CommandHandler("joke", joke_command))
    application.add_handler(CommandHandler("time", time_command))

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    print("=" * 60)
    print("ü§ñ AI –ë–û–¢ –° –≠–ú–£–õ–Ø–¶–ò–ï–ô –ò–ù–¢–ï–õ–õ–ï–ö–¢–ê")
    print("=" * 60)
    print("üöÄ –í–µ—Ä—Å–∏—è: 2.0 (–£–º–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è)")
    print(f"üîë –¢–æ–∫–µ–Ω: {TELEGRAM_TOKEN[:15]}...")
    print("üéØ –†–µ–∂–∏–º: –õ–æ–∫–∞–ª—å–Ω—ã–π AI (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö API)")
    print("üíæ –ü–∞–º—è—Ç—å: 10 —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å—Ç–æ—Ä–∏–∏")
    print("üòä –≠–º–æ—Ü–∏–∏: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è")
    print("=" * 60)
    print("üì± –ò–ù–°–¢–†–£–ö–¶–ò–Ø:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram")
    print("2. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞")
    print("3. –ù–∞–ø–∏—à–∏—Ç–µ /start")
    print("4. –û–±—â–∞–π—Ç–µ—Å—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ!")
    print("=" * 60)
    print("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –æ–±—â–µ–Ω–∏—é!")
    print("=" * 60)

    application.run_polling()


if __name__ == "__main__":
    main()